<!DOCTYPE html><html lang="en" data-astro-cid-37fxchfa> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/x-icon" href="/favicon.ico"><title>Node/Express/Sequelize RESTful API | Hello, World</title><meta name="description"><meta property="og:image"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="/_assets/_slug_.5Zos-WDK.css">
<style>.comments[data-astro-cid-on2fnc7p]{margin-top:2rem}.comments-title[data-astro-cid-on2fnc7p]{font-size:1.25rem;font-weight:600;color:#1f2937;margin-bottom:1rem}.giscus-container[data-astro-cid-on2fnc7p]{margin-top:1rem}.blog-post[data-astro-cid-bvzihdzo]{margin-bottom:2rem}.blog-title[data-astro-cid-bvzihdzo]{font-size:2rem;font-weight:700;color:#1f2937;margin-bottom:.5rem}@media (min-width: 768px){.blog-title[data-astro-cid-bvzihdzo]{font-size:2.25rem}}.blog-date[data-astro-cid-bvzihdzo]{display:block;font-size:.875rem;color:#6b7280;margin-bottom:2rem}.blog-content[data-astro-cid-bvzihdzo]{margin-top:1.5rem;line-height:1.7}.blog-content[data-astro-cid-bvzihdzo] h2{font-size:1.5rem;font-weight:600;color:#1f2937;margin:2rem 0 1rem}.blog-content[data-astro-cid-bvzihdzo] h3{font-size:1.25rem;font-weight:600;color:#1f2937;margin:1.5rem 0 1rem}.blog-content[data-astro-cid-bvzihdzo] p{margin-bottom:1.25rem}.blog-content[data-astro-cid-bvzihdzo] img{max-width:100%;height:auto;display:block;margin:2rem auto;border-radius:4px;box-shadow:0 2px 4px #0000001a}.blog-content[data-astro-cid-bvzihdzo] ul,.blog-content[data-astro-cid-bvzihdzo] ol{margin-left:2rem;margin-bottom:1.25rem}.blog-content[data-astro-cid-bvzihdzo] li{margin-bottom:.5rem}.blog-content[data-astro-cid-bvzihdzo] a{color:#0284c7;text-decoration:none}.blog-content[data-astro-cid-bvzihdzo] a:hover{text-decoration:underline}.comments-section[data-astro-cid-bvzihdzo]{margin-top:4rem;padding-top:2rem;border-top:1px solid #e5e7eb}
</style></head> <body style="min-height: 100vh; display: flex; flex-direction: column; background-color: #f9fafb;" data-astro-cid-37fxchfa> <div class="container-main" style="flex-grow: 1;" data-astro-cid-37fxchfa> <header class="header" data-astro-cid-3ef6ksr2> <div class="header-container" data-astro-cid-3ef6ksr2> <div class="brand" data-astro-cid-3ef6ksr2> <a href="/" class="site-title" data-astro-cid-3ef6ksr2>Hello, World</a> <a href="https://webring.wonderful.software#curiousdev.in.th" title="วงแหวนเว็บ" class="webring" data-astro-cid-3ef6ksr2> <img alt="วงแหวนเว็บ" width="32" height="32" src="https://webring.wonderful.software/webring.black.svg" class="webring-image" data-astro-cid-3ef6ksr2> </a> </div> <nav data-astro-cid-3ef6ksr2> <ul class="nav-list" data-astro-cid-3ef6ksr2> <li data-astro-cid-3ef6ksr2> <a href="/" class="nav-item" data-astro-cid-3ef6ksr2>Home</a> </li> <li data-astro-cid-3ef6ksr2> <a href="/blog" class="nav-item" data-astro-cid-3ef6ksr2>Blog</a> </li> <li data-astro-cid-3ef6ksr2> <a href="/about" class="nav-item" data-astro-cid-3ef6ksr2>About</a> </li> <li data-astro-cid-3ef6ksr2> <a href="/contact" class="nav-item" data-astro-cid-3ef6ksr2>Contact</a> </li> </ul> </nav> </div> </header>  <script type="module">const e=document.querySelectorAll("nav a");e.forEach(t=>{(t.getAttribute("href")===window.location.pathname||t.getAttribute("href")==="/blog"&&window.location.pathname.startsWith("/blog/"))&&t.setAttribute("aria-current","page")});</script> <main style="padding-top: 2rem; padding-bottom: 2rem;" data-astro-cid-37fxchfa>  <article class="blog-post" data-astro-cid-bvzihdzo> <h1 class="blog-title" data-astro-cid-bvzihdzo>Node/Express/Sequelize RESTful API</h1> <time class="blog-date" data-astro-cid-bvzihdzo>March 17, 2020</time> <div class="blog-content" data-astro-cid-bvzihdzo>  <p>สวัสดีครับผมมมม วันนี้จะขอนำเสนอบทความเกี่ยวกับการใช้ node.js ควบคู่กับ Sequelize.js ซึ่งเป็น Object Relational Mapping (ORM) ที่เป็นที่นิยมตัวนึงสำหรับไว้จัดการฐานข้อมูลที่เป็นแบบ Relational Database โดยผมจะแสดงการเชื่อมต่อระหว่าง express web server กับ sequelize แบบง่าย ๆ ก่อนนะครับ</p>
<p><a href="https://github.com/xeusteerapat/node-sequelize-rest-api">Github Repository</a></p>
<p><em>คำเตือน บทความนี้ผมเขียนเพื่อทบทวนสิ่งที่ได้เรียนใน coding bootcamp นะครับ ผิดพลาดประการใด สามารถ ping ผมได้ที่ twitter เลยนะครับ</em></p>
<h2 id="prerequisite">Prerequisite</h2>
<ul>
<li>Asynchronous JavaScript (Promise)</li>
<li>Basic Node.js/Express.js</li>
<li>พื้นฐานด้าน database นิดหน่อย</li>
</ul>
<p>เริ่มกันเลยดีกว่าครับ</p>
<h2 id="create-project">Create project</h2>
<p>สร้าง directory สำหรับ project ของเราก่อน</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash"><span class="token function">mkdir</span> restful-node-sequelize <span class="token operator">&#x26;&#x26;</span> <span class="token builtin class-name">cd</span> restful-node-sequelize
</code></pre>
<p>Initialize package ของเราก่อน</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash"><span class="token function">npm</span> init <span class="token parameter variable">-y</span>
</code></pre>
<p>ติดตั้ง dependencies ดังต่อไปนี้</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash"><span class="token function">npm</span> i express body-parser mysql2 sequelize <span class="token parameter variable">--save</span>
</code></pre>
<p>ติดตั้ง <code>nodemon</code> สำหรับไว้ restart server แบบ automatic</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash"><span class="token function">npm</span> i <span class="token parameter variable">-D</span> nodemon
</code></pre>
<p>แก้ไขคำสั่ง <code>script</code> ใน <code>package.json</code> นิดหน่อยครับ เพื่อที่เราจะได้ run คำสั่ง start server โดยให้เป็นดังนี้</p>
<pre class="language-javascript" data-language="javascript"><code is:raw="" class="language-javascript"> <span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"dev"</span><span class="token operator">:</span> <span class="token string">"node server.js"</span>
  <span class="token punctuation">}</span>
</code></pre>
<p>เราจะได้ <code>package.json</code> ออกมาหน้าแบบนี้</p>
<pre class="language-javascript" data-language="javascript"><code is:raw="" class="language-javascript"><span class="token punctuation">{</span>
  <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"restful-node-sequelize"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
  <span class="token string-property property">"main"</span><span class="token operator">:</span> <span class="token string">"index.js"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"dev"</span><span class="token operator">:</span> <span class="token string">"nodemon server.js"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"keywords"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">"author"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
  <span class="token string-property property">"license"</span><span class="token operator">:</span> <span class="token string">"ISC"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"body-parser"</span><span class="token operator">:</span> <span class="token string">"^1.19.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"express"</span><span class="token operator">:</span> <span class="token string">"^4.17.1"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"mysql2"</span><span class="token operator">:</span> <span class="token string">"^2.1.0"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"sequelize"</span><span class="token operator">:</span> <span class="token string">"^5.21.5"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"nodemon"</span><span class="token operator">:</span> <span class="token string">"^2.0.2"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>สร้างไฟล์​ <code>server.js</code> สำหรับไว้ run server ของเราครับ</p>
<p>คราวนี้ก็สร้าง express server app ของเราก่อน</p>
<h2 id="create-express-server">Create Express server</h2>
<pre class="language-javascript" data-language="javascript"><code is:raw="" class="language-javascript"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server listening on port 5000...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>run command <code>npm run dev</code> ที่ terminal ของเราดูครับ ถ้าได้แบบข้างล่าง ก็โอเคละครับบบบ</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash"><span class="token punctuation">[</span>nodemon<span class="token punctuation">]</span> <span class="token number">2.0</span>.2
<span class="token punctuation">[</span>nodemon<span class="token punctuation">]</span> to restart at any time, enter <span class="token variable"><span class="token variable">`</span>rs<span class="token variable">`</span></span>
<span class="token punctuation">[</span>nodemon<span class="token punctuation">]</span> watching dir<span class="token punctuation">(</span>s<span class="token punctuation">)</span>: *.*
<span class="token punctuation">[</span>nodemon<span class="token punctuation">]</span> watching extensions: js,mjs,json
<span class="token punctuation">[</span>nodemon<span class="token punctuation">]</span> starting <span class="token variable"><span class="token variable">`</span><span class="token function">node</span> server.js<span class="token variable">`</span></span>
Server listening on port <span class="token number">5000</span><span class="token punctuation">..</span>.
</code></pre>
<h2 id="create-database-models">Create Database Models</h2>
<p>กลับมาที่ sequelize กันบ้าง เราต้องติดตั้ง library เพิ่มเติมคือ sequelize-cli สำหรับไว้เป็นตัวช่วย config ค่าต่าง ๆ ของ database ของเรา เพื่อให้สามารถจัดการ code ของ database ได้ง่ายขึ้น</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash"><span class="token function">npm</span> i <span class="token parameter variable">-g</span> sequelize-cli
</code></pre>
<p>เมื่อติดตั้งเสร็จเรียบร้อยแล้ว ให้ใช้คำสั่ง <code>init:config</code> เพื่อสร้าง configuration file ขึ้นมา</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash">sequelize init:config
</code></pre>
<p>เราก็จะได้ <code>config.json</code> ไฟล์ใน folder <code>config</code> ออกมาหน้าตาเป็นแบบนี้</p>
<pre class="language-javascript" data-language="javascript"><code is:raw="" class="language-javascript"><span class="token punctuation">{</span>
  <span class="token string-property property">"development"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"username"</span><span class="token operator">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"password"</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token string-property property">"database"</span><span class="token operator">:</span> <span class="token string">"database_development"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"host"</span><span class="token operator">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"dialect"</span><span class="token operator">:</span> <span class="token string">"mysql"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"operatorsAliases"</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"test"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"username"</span><span class="token operator">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"password"</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token string-property property">"database"</span><span class="token operator">:</span> <span class="token string">"database_test"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"host"</span><span class="token operator">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"dialect"</span><span class="token operator">:</span> <span class="token string">"mysql"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"operatorsAliases"</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">"production"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"username"</span><span class="token operator">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"password"</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token string-property property">"database"</span><span class="token operator">:</span> <span class="token string">"database_production"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"host"</span><span class="token operator">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"dialect"</span><span class="token operator">:</span> <span class="token string">"mysql"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"operatorsAliases"</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>เราจะแก้ไขบางส่วนคือ password, database แล้วก็เพิ่ม timezone เข้าไปด้วยครับ จะได้</p>
<pre class="language-javascript" data-language="javascript"><code is:raw="" class="language-javascript">    <span class="token string-property property">"password"</span><span class="token operator">:</span> <span class="token operator">**</span><span class="token operator">**</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token comment">//  แล้วแต่ว่าตั้ง password ยังไงนะครับ</span>
    <span class="token string-property property">"database"</span><span class="token operator">:</span> <span class="token string">"football_team"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"timezone"</span><span class="token operator">:</span> <span class="token string">"+07:00"</span>
</code></pre>
<p>ต่อไปก็ทำการสร้าง models การเก็บข้อมูลของเราครับ</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash">sequelize init:models
</code></pre>
<p>เราจะได้ folder <code>models</code> พร้อมกับ file <code>index.js</code> เพื่อที่เราจะได้เรียกใช้ตอนที่ทำการ connect เข้ากับ server ของเราครับ</p>
<p><img  src="/_assets/models.C0zBgpWF_2tMjAs.webp" alt="models" width="580" height="560" loading="lazy" decoding="async"></p>
<p>ทำการสร้างไฟล์ขึ้นมาครับคือ <code>player.js</code> ใน folder <code>models</code> โดยที่ในไฟล์ <code>player.js</code> เราจะทำการ define structure ของ table รวมถึงกำหนดชื่อ columns และ property ต่าง ๆ ดังต่อไปนี้ครับ</p>
<ul>
<li>สร้าง table ชื่อ <code>player</code></li>
<li>โดยมี property:
<ul>
<li>name รับค่าเป็น <code>STRING</code></li>
<li>position รับค่าเป็น <code>STRING</code></li>
<li>year รับค่าเป็น <code>INTEGER</code></li>
</ul>
</li>
</ul>
<pre class="language-javascript" data-language="javascript"><code is:raw="" class="language-javascript">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sequelize<span class="token punctuation">,</span> DataTypes</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> player <span class="token operator">=</span> sequelize<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'player'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> DataTypes<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> DataTypes<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">year</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> DataTypes<span class="token punctuation">.</span><span class="token constant">INTEGER</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> player<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>ทีนี้ก็ทำการสร้าง database โดยใช้คำสั่ง</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash">sequelize db:create
</code></pre>
<p>ถ้าได้แบบข้างล่างก็คือว่าโอเคครับบ</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash">Sequelize CLI <span class="token punctuation">[</span>Node: <span class="token number">13.7</span>.0, CLI: <span class="token number">5.5</span>.1, ORM: <span class="token number">5.21</span>.5<span class="token punctuation">]</span>

Loaded configuration <span class="token function">file</span> <span class="token string">"config/config.json"</span><span class="token builtin class-name">.</span>
Using environment <span class="token string">"development"</span><span class="token builtin class-name">.</span>
<span class="token punctuation">(</span>node:13477<span class="token punctuation">)</span> <span class="token punctuation">[</span>SEQUELIZE0004<span class="token punctuation">]</span> DeprecationWarning: A boolean value was passed to options.operatorsAliases. This is a no-op with v5 and should be removed.
Database football_team created.
</code></pre>
<h2 id="connecting-database-to-server">Connecting database to server</h2>
<p>กลับมาที่ server ของเราอีกครั้งนะครับ ทีนี้เราต้องทำการเชื่อมต่อกับ database ของเรา โดยอาศัยชุด code ที่ถูกเขียนไว้ใน <code>models/index.js</code> ซึ่งเราต้องทำการ import มาที่ <code>server.js</code> ก่อน ก็จะเขียนประมาณนี้ครับ</p>
<pre class="language-javascript" data-language="javascript"><code is:raw="" class="language-javascript"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./models'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// import db from models/index.js</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span>sequelize<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port 5000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>ถ้ากลับไปเช็คที่ terminal จะเห็นว่า server ของเราเชื่อมต่อกับ database ได้แล้ววววว</p>
<p><img  src="/_assets/connecting_db.CEBmc7kp_1ugn80.webp" alt="connecting db" width="2318" height="608" loading="lazy" decoding="async"></p>
<h2 id="working-with-http-methods">Working with HTTP methods</h2>
<p>REST หรือ Representational State Transfer คือวิธีในการสร้าง Web Service ประเภทหนึ่งที่อาศัย HTTP Methods (GET, POST, PUT, DELETE) ในการทำงาน และส่งผลกลับมาในรูปแบบของ JSON โดยสามารถรับส่งข้อมูลไปมาข้าม Platform ได้อย่างสะดวก ซึ่งในแต่ละ methods เราจะทำการสร้างความสัมพันธ์กับ database ดังต่อไปนี้</p>
<h3 id="post-method">POST method</h3>
<p>เนื่องจาก database ของเรายังไม่มีอะไร ดังนั้นผมจะทำการสร้างข้อมูลลงไปก่อนนะครับ แบบนี้</p>
<pre class="language-javascript" data-language="javascript"><code is:raw="" class="language-javascript"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./models'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// import db from models/index.js</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// add new player to database with POST method</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/players'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> newPlayer <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    <span class="token literal-property property">position</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>position<span class="token punctuation">,</span>
    <span class="token literal-property property">year</span><span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>year<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  db<span class="token punctuation">.</span>player
    <span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>newPlayer<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span>sequelize<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port 5000...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>ทีนี้เราจะใช้ tool อย่าง “Postman” เพื่อช่วยเราทำ post request ครับ ทำการเพิ่ม player เข้าไป ก็จะได้ประมาณนี้</p>
<p><img  src="/_assets/post.CSFK225h_ZzujsN.webp" alt="post method" width="1918" height="1048" loading="lazy" decoding="async"></p>
<p>เรายังสามารถเช็ค database ของเรา ผ่านทาง <code>mysql-cli</code> ใน terminal หรือใครจะเช็คจาก mySQL workbench ก็ได้เหมือนกันครับ เราสามรถเรียกดู table ที่สร้างไว้โดยใช้คำสัง SQL ปกติได้เลยครับ (ผมเพิ่มเข้าไปอีก 3-4 จะได้ดูมีข้อมูลหน่อย)</p>
<pre class="language-bash" data-language="bash"><code is:raw="" class="language-bash">mysql <span class="token parameter variable">-u</span> root <span class="token parameter variable">-p</span>
// จากนั้นก็ใส่ password ลงไป
</code></pre>
<p>ลองใช้คำสั่ง <code>SELECT * FROM football_team.players</code> ดู ก็จะได้แบบนี้</p>
<p><img  src="/_assets/query.CtLIrBYh_Z16Gxwt.webp" alt="query" width="2010" height="576" loading="lazy" decoding="async"></p>
<h3 id="get-method">GET method</h3>
<p><code>GET</code> method ก็คือการที่ให้เว็บแสดงข้อมูลตามที่มีการ request เข้ามาตาม url ที่ระบุไว้ ในที่นี้ผมจะให้เป็น <code>/players</code> นะครับ ก็ใช้ postman เหมือนเดิม แต่เปลี่ยนเป็น GET method ก็จะได้ players ทั้งหมดที่สร้างไว้ตั้งแต่ตอนแรกครับ</p>
<pre class="language-javascript" data-language="javascript"><code is:raw="" class="language-javascript">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/players'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  db<span class="token punctuation">.</span>player<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>ก็จะได้ผลลัพธ์ประมาณนี้</p>
<p><img  src="/_assets/get.BIjDpKXt_Zph7x8.webp" alt="get" width="1738" height="1656" loading="lazy" decoding="async"></p>
<h3 id="put-method">PUT method</h3>
<p>ถ้าเราอยากจะเปลี่ยนแปลงข้อมูลของเรา ก็สามารถทำได้โดยใช้ PUT method ครับ ผมจะเปลี่ยนโดยอ้างอิงจาก id ของข้อมูลเป็นหลักนะครับ โดยจะเปลี่ยนชื่อของ player ก็สามารถทำได้แบบนี้</p>
<pre class="language-javascript" data-language="javascript"><code is:raw="" class="language-javascript">app<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'/players/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  db<span class="token punctuation">.</span>player
    <span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span>sequelize<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port 5000...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>เหมือนเดิมครับใช้ postman แต่เปลี่ยนเป็น put method แล้วใส่ endpoint ตาม code ของเรา ลองเปลี่ยนค่าจาก Pepe เป็น Martinelli ดู</p>
<p><img  src="/_assets/put.B7ELSzYU_Z14tI1o.webp" alt="put method" width="1732" height="818" loading="lazy" decoding="async"></p>
<p>แล้วทีนี้ลองเช็ค GET method เพื่อเรียกรายชื่อ player ออกมาอีกที จะเห็นว่า Martinelli ไปแทนที่ Pepe เรียบร้อย</p>
<p><img  src="/_assets/new_get_result.U5fGVudI_1LS0CS.webp" alt="new result" width="1742" height="1116" loading="lazy" decoding="async"></p>
<h3 id="delete-method">DELETE method</h3>
<p>Method สุดท้ายก็ตรงตัวเลยครับ ลบข้อมูลออกจาก database ของเรา วิธีการก็คล้าย ๆ กับ PUT method ซึ่งผมจะลบโดยอ้างอิงจาก id เป็นหลัก</p>
<pre class="language-javascript" data-language="javascript"><code is:raw="" class="language-javascript">app<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'/players/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  db<span class="token punctuation">.</span>player
    <span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">where</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Player deleted!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>ก้จะได้ผลลัพธ์ใน postman ดังนี้ครับ</p>
<p><img  src="/_assets/delete.iWE-jUDD_1LS8Xk.webp" alt="delete" width="996" height="640" loading="lazy" decoding="async"></p>
<p>พอเช็คจำนวน player ที่เหลืออยู่ใน database จาก GET method ก็จะเหลืออยู่แแค่นี้ (ผมลบตัวอื่นออกไปด้วยจนเหลือแค่ 2 คน)</p>
<p><img  src="/_assets/last_result.BL8ip366_Z2bWx1j.webp" alt="last result" width="1226" height="1104" loading="lazy" decoding="async"></p>
<p>ซึ่งก็ตรงตามใน table ของ mySQL ครับ</p>
<p><img  src="/_assets/mySQL_last_result.CrTTara2_ZU8OrN.webp" alt="mysql_last_result" width="1894" height="454" loading="lazy" decoding="async"></p>
<p>คร่าว ๆ ก็จะประมาณนี้นะครับ ยังมี concept บางตัวที่ผมยังไม่เข้าใจครบถ้วน 100% ยังอธิบายได้ไม่ค่อยดีเท่าไหร่ โดยเฉพาะ ORM Concept และ REST API Concept ก็ขออภัยด้วยนะครับ ถ้าเจออะไรเพิ่มเติม จะกลับมาเขียนเพิ่มครับผมมมม</p>
<p>Happy Coding :)</p>  </div> </article> <div class="comments-section" data-astro-cid-bvzihdzo> <section class="comments" data-astro-cid-on2fnc7p> <h2 class="comments-title" data-astro-cid-on2fnc7p>Comments</h2> <div class="giscus-container" data-astro-cid-on2fnc7p> <script src="https://giscus.app/client.js" data-repo="xeusteerapat/xeusteerapat.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkyMTkyNTY4NzY=" data-category="General" data-category-id="DIC_kwDODRGYLM4COf8-" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="en" crossorigin="anonymous" async>
    </script> </div> </section>  </div>  </main> </div> <footer class="footer" data-astro-cid-sz7xmlte> <div class="container-main footer-content" data-astro-cid-sz7xmlte> <div class="social-links" data-astro-cid-sz7xmlte> <a href="https://github.com/xeusteerapat" target="_blank" rel="noopener noreferrer" class="social-link" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>GitHub</span> <svg class="social-icon" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-astro-cid-sz7xmlte> <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd" data-astro-cid-sz7xmlte></path> </svg> </a> <a href="https://twitter.com/xeusteerapat" target="_blank" rel="noopener noreferrer" class="social-link" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Twitter</span> <svg class="social-icon" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-astro-cid-sz7xmlte> <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84" data-astro-cid-sz7xmlte></path> </svg> </a> <a href="https://www.linkedin.com/in/teerapat-prommarak/" target="_blank" rel="noopener noreferrer" class="social-link" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>LinkedIn</span> <svg class="social-icon" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true" data-astro-cid-sz7xmlte> <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" data-astro-cid-sz7xmlte></path> </svg> </a> </div> <p class="copyright" data-astro-cid-sz7xmlte>
Created by Teerapat Prommarak, © 2025 </p> </div> </footer>  </body></html> 